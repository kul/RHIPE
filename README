Code for the new version of RHIPE